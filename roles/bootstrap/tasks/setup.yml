---
# tasks file for bootstrap

- name: Change shell to zsh
  command: "chsh -s /bin/zsh {{ bootstrap_user }}"
  register: output
- debug:
    msg: "{{ output.stdout_lines }}"

- name: Install latest Node LTS version
  become: yes
  become_user: "{{ bootstrap_user }}"
  shell: |
    . {{ bootstrap_user_dir }}/.zshrc
    nvm install --lts --latest-npm
  args:
    executable: /usr/bin/zsh
  register: output
- debug:
    msg: "{{ output.stdout_lines }}"

- name: Install latest Rust toolchain
  become: yes
  become_user: "{{ bootstrap_user }}"
  shell: |
    . {{ bootstrap_user_dir }}/.zshrc
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- --no-modify-path -y
    rustup component add rls rust-analysis rust-src
    rustup update
    cargo install cargo-tree cargo-edit || true
  args:
    executable: /usr/bin/zsh
    warn: no
  register: output
- debug:
    msg: "{{ output.stdout_lines }}"
